!function(b,a){"function"==typeof define&&define.amd?define(["jquery"],function(b){return a(b)}):"object"==typeof module&&module.exports?module.exports=a(require("jquery")):a(b.jQuery)}(this,function(a){var $;($=a).fn.iframeTracker=function(a){"function"==typeof a&&(a={blurCallback:a});var b=this.get();if(null===a|| !1===a)$.iframeTracker.untrack(b);else if("object"==typeof a)$.iframeTracker.track(b,a);else throw new Error("Wrong handler type (must be an object, or null|false to untrack)");return this},$.iframeTracker={focusRetriever:null,focusRetrieved:!1,handlersList:[],isIE8AndOlder:!1,init:function(){try{!0===$.browser.msie&&$.browser.version<9&&(this.isIE8AndOlder=!0)}catch(b){try{navigator.userAgent.match(/(msie) ([\w.]+)/i)[2]<9&&(this.isIE8AndOlder=!0)}catch(c){}}if($(window).focus(),$(window).blur(function(a){$.iframeTracker.windowLoseFocus(a)}),$("body").append('<div style="position:fixed; top:0; left:0; overflow:hidden;" id="HiddenDiv"><input style="position:absolute; left:-300px;" type="text" value="" id="focus_retriever" readonly="true" /></div>'),this.focusRetriever=$("#focus_retriever"),this.focusRetrieved=!1,this.isIE8AndOlder){this.focusRetriever.blur(function(a){a.stopPropagation(),a.preventDefault(),$.iframeTracker.windowLoseFocus(a)}),$("body").click(function(a){$(window).focus()}),$("form").click(function(a){a.stopPropagation()});try{$("body").on("click","form",function(a){a.stopPropagation()})}catch(a){console.log("[iframeTracker] Please update jQuery to 1.7 or newer. (exception: "+a.message+")")}}},track:function(b,a){a.target=b,$.iframeTracker.handlersList.push(a),$(b).bind("mouseover",{handler:a},$.iframeTracker.mouseoverListener).bind("mouseout",{handler:a},$.iframeTracker.mouseoutListener)},untrack:function(b){if("function"!=typeof Array.prototype.filter){console.log("Your browser doesn't support Array filter, untrack disabled");return}$(b).each(function(a){$(this).unbind("mouseover",$.iframeTracker.mouseoverListener).unbind("mouseout",$.iframeTracker.mouseoutListener)});var c=function(a){return null!==a};for(var a in this.handlersList){for(var d in this.handlersList[a].target)-1!==$.inArray(this.handlersList[a].target[d],b)&&(this.handlersList[a].target[d]=null);this.handlersList[a].target=this.handlersList[a].target.filter(c),0===this.handlersList[a].target.length&&(this.handlersList[a]=null)}this.handlersList=this.handlersList.filter(c)},mouseoverListener:function(a){a.data.handler.over=!0,$.iframeTracker.retrieveFocus();try{a.data.handler.overCallback(this,a)}catch(b){}},mouseoutListener:function(a){a.data.handler.over=!1,$.iframeTracker.retrieveFocus();try{a.data.handler.outCallback(this,a)}catch(b){}},retrieveFocus:function(){document.activeElement&&"IFRAME"===document.activeElement.tagName&&($.iframeTracker.focusRetriever.focus(),$.iframeTracker.focusRetrieved=!0)},windowLoseFocus:function(b){for(var a in this.handlersList)if(!0===this.handlersList[a].over)try{this.handlersList[a].blurCallback(b)}catch(c){}}},$(document).ready(function(){$.iframeTracker.init()})})